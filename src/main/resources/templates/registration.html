<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html" lang="ja">
<head>
    <meta charset="UTF-8">
    <title>registration</title>
<!--    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">-->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script th:src="@{/js/chatgpt.js}"></script>
</head>
<body>
<nav class="nav nav-pills nav-justified">
    <a class="nav-link" th:href="@{/list}">食品</a>
    <a class="nav-link" th:href="@{/dailylistd}">日用品</a>
    <a class="nav-link" th:href="@{/emglist}">防災備蓄</a>
    <a class="nav-link active" aria-current="page" >登録</a>
</nav><br><br>
            <div class="tab" id="tab">
                <input type="button" button class="btn btn-danger" onclick="location.href='#reg'" value="食品">
                <input type="button" button class="btn btn-success" onclick="location.href='#d_reg'" value="日用品">
                <input type="button" button class="btn btn-warning" onclick="location.href='#emg_reg'" value="防災備蓄品">
                <input type="button" button class="btn btn-info" onclick="location.href='#memo_reg'" value="買い物メモ">
            </div>
<br><br>

<div class="food_reg" id="reg">
  <thead>
    <script type="text/javascript">
           window.onload = function() {
                 document.getElementById('strage_subtype').style.display="none";
                            }
                 function selectType() {
                            let id = document.getElementById('strage_type').value;

                            if(id=='常温'){
                                        document.getElementById('strage_subtype').style.display="";
                             }else{
                                        document.getElementById('strage_subtype').style.display="none";
                             }
                 }
    </script>
  </thead>
    <h4>食品ストックの登録</h4>
    <form action="/add">
        <table class=" ">
            <table>
                 <tr>
                    <th><label>ストック名</label></th>
                    <td><input name="stock" class="form-control" type="text" /></td>
                </tr>
                <tr>
                    <th><label>買い物メモ</label></th>
                    <td><input name="memo" class="form-control" type="text" /></td>
                </tr>
                <tr>
                    <th><label>個数</label></th>
                    <td><input name="qty" class="form-control" type="number" min="0" max="25" value="" /></td>
                </tr>
                <tr>
                    <th><label>保管種別</label></th>
                    <td>
                      <div>
                        <select id="strage_type" class="form-control" name="type" onchange="selectType()">
                            <option>    </option>
                            <option value="冷凍">冷凍</option>
                            <option value="冷蔵">冷蔵</option>
                            <option value="常温">常温</option>
                        </select>
                      </div>
                            <div>
                                <select id="strage_subtype" class="form-control" name="subtype">
                                    <option>    </option>id
                                    <option>野菜</option>
                                    <option>ソース・素</option>
                                    <option>菓子</option>
                                </select>
                            </div>
                    </td>
                </tr>
                <tr>
                    <th><label>使用可否</label></th>
                    <td>
                        <select id="strage_uby" class="form-control" name="uby">
                            <option>    </option>
                            <option>可</option>
                            <option>不可</option>
                        </select>
                    </td>
            </table><br>
              <div class="row">
                <span style="margin-right: 16em;">
                <button type="submit" class="btn btn-primary" id="add_buttom"
                    onclick="action='/add'; submit();">登録</button>
                </span>
<!--                <div class="d-grid gap-2 d-md-flex justify-content-md-end">-->
                <a class="btn btn-outline-info" role="button" onclick="location.href='#tab'" >△</a>
<!--                </div>-->
              </div>
        </table>
    </form>
</div>

<br><br>
<div class="daily_reg" id="d_reg">
    <h4>日用品ストックの登録</h4>
    <form action="/dailyadd">
        <table class=" ">
            <table>
                <tr>
                    <th><label>ストック名</label></th>
                    <td><input name="daily" class="form-control" type="text" /></td>
                </tr>
                <tr>
                    <th><label>買い物メモ</label></th>
                    <td><input name="memo" class="form-control" type="text" /></td>
                </tr>
                <tr>
                    <th><label>個数</label></th>
                    <td><input name="qty" class="form-control" type="number" min="0" max="25" value="" /></td>
                </tr>
                <tr>
                    <th><label>保管種別</label></th>
                    <td>
                        <select id="strage_dailytype" class="form-control" name="type">
                            <option>    </option>
                            <option>洗剤</option>
                            <option>紙類</option>
                            <option>その他</option>
                        </select>
                    </td>
                </tr>
            </table><br>
            <div class="row">
                <span style="margin-right: 16em;">
                 <button type="submit" class="btn btn-primary" id="dailyadd_buttom"
                    onclick="action='/dailyadd' location.th:href='@{/daily}'; submit();">登録</button>
                 </span>
                　<a class="btn btn-outline-info" role="button" onclick="location.href='#tab'" >△</a>
            </div>
            </table>
    </form>
</div><br><br>

<div class="emergency_reg" id="emg_reg">
    <h4>防災備蓄品ストックの登録</h4>
    <form action="/emgadd">
        <table class=" ">
            <table>
                <tr>
                    <th><label>ストック名</label></th>
                    <td><input name="stock" class="form-control" type="text" /></td>
                </tr>
                <tr>
                    <th><label>買い物メモ</label></th>
                    <td><input name="memo" class="form-control" type="text" /></td>
                </tr>
                <tr>
                    <th><label>個数</label></th>
                    <td><input name="qty" class="form-control" type="number" min="0" max="25" value="" /></td>
                </tr>
                <tr>
                    <th><label>保管種別</label></th>
                    <td>
                        <select id="emg_type" class="form-control" name="type">
                            <option>    </option>
                            <option>飲料</option>
                            <option>食料</option>
                            <option>ガス・電気</option>
                            <option>備品</option>
                        </select>
                    </td>
                </tr>
                <tr>
                        <th><label>消費期限</label></th>
                        <td><input name="exp" class="form-control" type="date" /></td>
                </tr>
        </table><br>
           <div class="row">
             <span style="margin-right: 16em;">
             <button type="submit" class="btn btn-primary" id="emgadd_buttom"
                    onclick="action='/emgadd' location.th:href='@{/emergency}'; submit();">登録</button>
             </span>
             <a class="btn btn-outline-info" role="button" onclick="location.href='#tab'" >△</a>
            </div>
        </table>
    </form>
</div><br><br>
<div class="shopping_memo" id="memo_reg">
      <h5>買い物メモ</h5>
        <div><form name="memoform" id="memoform" role="form">
            <tr>
                <td><input name="message" class="form-control" type="text" style="width:850px; height:80px;"/></td>
            </tr>
            <button type="submit" class="btn btn-success"
                    name="btnsubmit" id="btnSend" ;>送信</button>
        </form>
        </div>
</div><br><br>
<div class="recipi_consul" id="recipi_con">
    <h5>レシピ検索</h5>
    <div class="low">
    <div class="chat-input-area">
        <input type="text" id="input-field"/>
        <input type="button" class = "btn btn-second" value="chatGPT" id="send-button">
    </div>
    <div class="chat-response-area">
    </div><br>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <div class="recipi_site" >
            <label class="go_to_label"> レシピ検索サイト</label>
            <button type="submit" class="btn btn-info" id=go_to_btn"　name="go_to_btn"
                    onclick="action='/check_exp'; submit();">クックパッド</button>
        </div><br>
    </div>
</div>
        <script>
                $(document).ready(function() {
                 $('#btnSend').click(function() {
                    $("#btnSend").prop("disabled", true);
                  // フォームのデータをJSONに変換
                    var rawData = $('#memoform').serializeArray();
                    var data = {};
                    jQuery.each(rawData, function(i, e) {
                    data[e.name] = e.value;
                });
                // Ajaxを使ってメールを送信
                $.ajax({
                    type: "POST",
                    url: "./sendmail",
                    dataType: "json",
                    data: JSON.stringify(data),
                    contentType: 'application/json',
                    scriptCharset: 'utf-8',
                    success: function(outdata, dataType) {
                    if (outdata[0] == "OK") alert("メール送信しました");
                     $("#btnSend").prop("disabled", false);
                     },
                    error: function(XMLHttpRequest, textStatus, errorThrown) {
                    alert("Error : " + errorThrown);
                    $("#btnSend").prop("disabled", false);
                            }
                        });
                     });
                });
            </script>
            <script>
             　  window.addEventListener('load', (event) => {

                document.querySelectorAll('a[href^="#"]').forEach(e => e.addEventListener('click', function(e){
                    e.preventDefault();

                    let target = e.target.getAttribute("href");

                    let targetTop = document.querySelector(target).getBoundingClientRect().top + window.pageYOffset;

                    let scrollOptions = {
                      left: 0,
                      top: targetTop,
                      behavior: 'smooth'
                    }
                    window.scrollTo(scrollOptions);
                }));
            });
            </script>
</body>
</html>
